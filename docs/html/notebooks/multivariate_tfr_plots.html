<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Multiviariate TFR statistics, a mini-tutorial &#8212; tfrStats 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=55c3aa90" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=af2ce170"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link href="../_static/style.css" rel="stylesheet" type="text/css">

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo_2.jpg" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Content:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../uvtfrs.html">1. On TFR statistical assessments</a></li>
<li class="toctree-l1"><a class="reference internal" href="univariate_tfr_stats.html">2. Univariate TFR statistics, a mini-tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="multivariate_tfr_stats.html">3. Multiviariate TFR statistics, a mini-tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">tfrStats</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="Multiviariate-TFR-statistics,-a-mini-tutorial">
<h1>Multiviariate TFR statistics, a mini-tutorial<a class="headerlink" href="#Multiviariate-TFR-statistics,-a-mini-tutorial" title="Permalink to this heading">¶</a></h1>
<p>To run the <a class="reference external" href="https://github.com/nicogravel/tfrStats/blob/main/docs/html/notebooks/multivariate_tfr_stats.ipynb">notebook</a>, clone the package (or your fork) locally and then:</p>
<section id="Compute-RDM-reliability-using-permutations">
<h2>Compute RDM reliability using permutations<a class="headerlink" href="#Compute-RDM-reliability-using-permutations" title="Permalink to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import os
import numpy as np
from tfrStats.load_tfr_rdm import load_tfr_rdm as load_tfr_rdm
from tfrStats.mvtfr_reliability import mvtfr_reliability as mvtfr_reliability

fbands  = [&#39;low&#39;,&#39;high&#39;,&#39;higher&#39;,&#39;mua&#39;]
blocks   = [&#39;grat&#39;, &#39;nat&#39;,&#39;obj&#39;,&#39;bck&#39;]

conds   = [&#39;grat&#39;, &#39;bck&#39;,&#39;obj&#39;,&#39;bck-obj&#39;,&#39;grat_lowcon&#39;,&#39;grat_highcon&#39;,&#39;bckXobj&#39;]
conds   = [&#39;grat&#39;, &#39;nat&#39;, &#39;bck&#39;,&#39;obj&#39;,&#39;grat_lowcon&#39;,&#39;grat_highcon&#39;,&#39;bckXobj&#39;]


example_data = &#39;/Volumes/Gandalf/MWlamprop/results/stats/multivariate/&#39;
#example_data = &#39;/Users/nicogravel/Documents/Websites/tfrStats/tfrStats_local/docs/source/notebooks/example_data/&#39;



# Loop over blocks and frequency bands
for  block in range(3,4):
    for  fband in range(3):

        # Configure inputs
        conf = {
            &#39;paths&#39;    : [
            &#39;/Users/nicogravel/Documents/Gandalf/MWlamprop/data/results_bckp/&#39;,
            # &#39;/mnt/hpc_slurm/projects/MWlamprop/Analysis/02_data/spectral_dec/&#39;
            #&#39;/mnt/hpc/projects/MWlamprop/Analysis/02_data/preprocessed/&#39;,
            #&#39;/mnt/pns/home/graveln/Documents/MWlamprop/results/spectral_dec/&#39;,
            #&#39;/mnt/hpc/projects/MWlamprop/Analysis/02_data/spectral_dec/&#39;,
            &#39;/Volumes/Gandalf/MWlamprop/data/&#39;,
            #&#39;/Users/nicogravel/Documents/Gandalf/MWlamprop/data/results_bckp/&#39;,
            #&#39;/Users/nicogravel/Documents/Gandalf/MWlamprop/data/processed/spectral_dec/&#39;,
            &#39;/Volumes/Gandalf/MWlamprop/results/&#39;
            ],
            &#39;methods&#39;  : [&#39;spectral&#39;,&#39;mvpa&#39;],
            &#39;decvars&#39;  : [&#39;spw&#39;,&#39;gpr&#39;,&#39;spwgpr&#39;],
            &#39;method&#39;   : 1,
            &#39;dvar&#39;     : 0,
            &#39;fband&#39;    : fband,
            &#39;cond&#39;     : block,
            &#39;sess&#39;     : 0,
            &#39;layers&#39;   : False,
            &#39;lump&#39;     : True,
            &#39;rsa&#39;      : True,
            &#39;n_perm&#39;   : 1000
            }

        # Load data
        rdms  = load_tfr_rdm(conf)

        #rdm1 = rdms[&#39;rdm_split1&#39;]
        #rdm2 = rdms[&#39;rdm_split2&#39;]
        #rdm  = rdms[&#39;rdm_whole&#39;]
        #print(rdm.shape)

        # Compute reliability
        tfr, tfr_null = mvtfr_reliability(rdms,conf)

        # Prepare outputs
        tfrs = {
                &#39;tfr&#39;  : tfr,
                &#39;tfr_null&#39;  : tfr_null,
            }

        # Save outputs
        fname = os.path.join(example_data + &#39;mvtfr_&#39;
                    + blocks[block] + &#39;_&#39;
                    + fbands[fband] + &#39;_&#39; + str(conf[&#39;n_perm&#39;])
                    + &#39;.npy&#39;)
        print(fname)
        np.save(fname,tfrs)
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
session:  0
(12, 19, 36, 36, 57)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "51bbaae0ad3b4ba9b9ddc3724ec3a489", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/Volumes/Gandalf/MWlamprop/results/stats/multivariate/mvtfr_bck_low_1000.npy
session:  0
(12, 16, 36, 36, 113)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "81eaaf28a7ab456789f295855b2242d8", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/Volumes/Gandalf/MWlamprop/results/stats/multivariate/mvtfr_bck_high_1000.npy
session:  0
(12, 11, 36, 36, 141)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "01e9abbb2b8c4c62825ccf02b3424b12", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/Volumes/Gandalf/MWlamprop/results/stats/multivariate/mvtfr_bck_higher_1000.npy
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Save outputs
fname = os.path.join(example_data + &#39;mvtfr_&#39;
            + blocks[block] + &#39;_&#39;
            + fbands[fband] + &#39;_&#39; + str(conf[&#39;n_perm&#39;])
            + &#39;.npy&#39;)
print(fname)
np.save(fname,tfrs)
</pre></div>
</div>
</div>
</section>
<section id="Plot-RDM-reliability">
<h2>Plot RDM reliability<a class="headerlink" href="#Plot-RDM-reliability" title="Permalink to this heading">¶</a></h2>
<p>Similarly to the problem of taking the extreme values at each iteration of the permutaion when computing univariate TFRs. Whern computing multivariate TFRs, one is confronted with the decisio of whether to take the extreme value or the average.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import numpy as np
from tfrStats.plot_mvtfr_stats import plot_mvtfr_stats as plot_mvtfr_stats

results      = &#39;/Volumes/Gandalf/MWlamprop/results/stats/multivariate/&#39;
example_data = &#39;/Users/nicogravel/Documents/Websites/tfrStats/tfrStats_local/docs/source/notebooks/example_data/&#39;

blocks       = [&#39;grat&#39;, &#39;nat&#39;, &#39;bck&#39;, &#39;obj&#39;]
fbands       = [&#39;low&#39;,&#39;high&#39;,&#39;higher&#39;]

fband        = 0
cond         = 0

#fname = str(example_data + &#39;mvtfr_example_&#39; + fbands[fband] + &#39;.npy&#39;)
fname = str(results + &#39;mvtfr_&#39; + blocks[cond] + &#39;_&#39; + fbands[fband] + &#39;.npy&#39;)
tfrs = np.load(fname,allow_pickle=True).item()
tfr = tfrs[&#39;tfr&#39;]
tfr_null = tfrs[&#39;tfr_null&#39;]

plot_mvtfr_stats(cond, tfr, tfr_null, fband, alpha = 0.05, correction=&#39;space&#39;)
plot_mvtfr_stats(cond, tfr, tfr_null, fband, alpha = 0.05, correction=&#39;frequency&#39;)
plot_mvtfr_stats(cond, tfr, tfr_null, fband, alpha = 0.05, correction=&#39;space-frequency&#39;)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import numpy as np
from tfrStats.plot_mvtfr_stats import plot_mvtfr_stats as plot_mvtfr_stats

results      = &#39;/Volumes/Gandalf/MWlamprop/results/stats/multivariate/&#39;
example_data = &#39;/Users/nicogravel/Documents/Websites/tfrStats/tfrStats_local/docs/source/notebooks/example_data/&#39;

blocks       = [&#39;grat&#39;, &#39;nat&#39;, &#39;bck&#39;, &#39;obj&#39;]
fbands       = [&#39;low&#39;,&#39;high&#39;,&#39;higher&#39;]

fband        = 1
cond         = 0

#fname = str(example_data + &#39;mvtfr_example_&#39; + fbands[fband] + &#39;.npy&#39;)
fname = str(results + &#39;mvtfr_&#39; + blocks[cond] + &#39;_&#39; + fbands[fband] + &#39;.npy&#39;)
tfrs = np.load(fname,allow_pickle=True).item()
tfr = tfrs[&#39;tfr&#39;]
tfr_null = tfrs[&#39;tfr_null&#39;]

plot_mvtfr_stats(cond, tfr, tfr_null, fband, alpha = 0.05, correction=&#39;space&#39;)
plot_mvtfr_stats(cond, tfr, tfr_null, fband, alpha = 0.05, correction=&#39;frequency&#39;)
plot_mvtfr_stats(cond, tfr, tfr_null, fband, alpha = 0.05, correction=&#39;space-frequency&#39;)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import numpy as np
from tfrStats.plot_mvtfr_stats import plot_mvtfr_stats as plot_mvtfr_stats

results      = &#39;/Volumes/Gandalf/MWlamprop/results/stats/multivariate/&#39;
example_data = &#39;/Users/nicogravel/Documents/Websites/tfrStats/tfrStats_local/docs/source/notebooks/example_data/&#39;

blocks       = [&#39;grat&#39;, &#39;nat&#39;, &#39;bck&#39;, &#39;obj&#39;]
fbands       = [&#39;low&#39;,&#39;high&#39;,&#39;higher&#39;]

fband        = 2
cond         = 0

#fname = str(example_data + &#39;mvtfr_example_&#39; + fbands[fband] + &#39;.npy&#39;)
fname = str(results + &#39;mvtfr_&#39; + blocks[cond] + &#39;_&#39; + fbands[fband] + &#39;.npy&#39;)
tfrs = np.load(fname,allow_pickle=True).item()
tfr = tfrs[&#39;tfr&#39;]
tfr_null = tfrs[&#39;tfr_null&#39;]

plot_mvtfr_stats(cond, tfr, tfr_null, fband, alpha = 0.05, correction=&#39;space&#39;)
plot_mvtfr_stats(cond, tfr, tfr_null, fband, alpha = 0.05, correction=&#39;frequency&#39;)
plot_mvtfr_stats(cond, tfr, tfr_null, fband, alpha = 0.05, correction=&#39;space-frequency&#39;)
</pre></div>
</div>
</div>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;in dog we trust.
      
      |
      <a href="../_sources/notebooks/multivariate_tfr_plots.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>