<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Plot decoding curves &#8212; tfrStats 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=218a107a" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=af2ce170"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link href="../_static/style.css" rel="stylesheet" type="text/css">

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo_2.jpg" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Content:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../uvtfrs.html">1. On TFR statistical assessments</a></li>
<li class="toctree-l1"><a class="reference internal" href="univariate_tfr_stats.html">2. Univariate TFR statistics, a mini-tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="multivariate_tfr_stats.html">3. Multiviariate TFR statistics, a mini-tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">tfrStats</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="Plot-decoding-curves">
<h1>Plot decoding curves<a class="headerlink" href="#Plot-decoding-curves" title="Permalink to this heading">¶</a></h1>
<p>Here we plot average RDM (classification accuracy curves) for MUA, bipolar-LFP and TFRs (average of a frequency band).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tfrMVPA.plot_tfr_rdm</span> <span class="kn">import</span> <span class="n">plot_tfr_rdm</span> <span class="k">as</span> <span class="n">plot_tfr_rdm</span>

<span class="n">conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;paths&#39;</span>    <span class="p">:</span> <span class="p">[</span>
    <span class="s1">&#39;/Users/nicogravel/Documents/Gandalf/MWlamprop/data/results_bckp/&#39;</span><span class="p">,</span>
    <span class="c1"># &#39;/mnt/hpc_slurm/projects/MWlamprop/Analysis/02_data/spectral_dec/&#39;</span>
    <span class="c1">#&#39;/mnt/hpc/projects/MWlamprop/Analysis/02_data/preprocessed/&#39;,</span>
    <span class="c1">#&#39;/mnt/pns/home/graveln/Documents/MWlamprop/results/spectral_dec/&#39;,</span>
    <span class="c1">#&#39;/mnt/hpc/projects/MWlamprop/Analysis/02_data/spectral_dec/&#39;,</span>
    <span class="s1">&#39;/Volumes/Gandalf/MWlamprop/data/&#39;</span><span class="p">,</span>
    <span class="s1">&#39;/Volumes/Gandalf/MWlamprop/results/&#39;</span>
    <span class="p">],</span>
    <span class="s1">&#39;block&#39;</span>  <span class="p">:</span> <span class="s1">&#39;grat&#39;</span><span class="p">,</span> <span class="c1"># &#39;both&#39;, &#39;objects&#39;, &#39;scenes&#39;</span>
    <span class="s1">&#39;subset&#39;</span> <span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;prctl&#39;</span>  <span class="p">:</span><span class="mi">99</span><span class="p">,</span>
    <span class="s1">&#39;lump&#39;</span>   <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;rsa&#39;</span>    <span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;newData&#39;</span><span class="p">:</span> <span class="kc">True</span>
    <span class="p">}</span>

<span class="n">plot_tfr_rdm</span><span class="p">(</span><span class="n">conf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
30
session:  0
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">/Users/nicogravel/Documents/Websites/tfrStats/tfrMVPA_local/docs/source/notebooks/layer_approach.ipynb Cell 2</span> line <span class="ansi-cyan-fg">2
</span><span class="ansi-green-intense-fg ansi-bold">      &lt;a href=&#39;vscode-notebook-cell:/Users/nicogravel/Documents/Websites/tfrStats/tfrMVPA_local/docs/source/notebooks/layer_approach.ipynb#W1sZmlsZQ%3D%3D?line=0&#39;&gt;1&lt;/a&gt;</span> from tfrMVPA.plot_tfr_rdm import plot_tfr_rdm as plot_tfr_rdm
<span class="ansi-green-intense-fg ansi-bold">      &lt;a href=&#39;vscode-notebook-cell:/Users/nicogravel/Documents/Websites/tfrStats/tfrMVPA_local/docs/source/notebooks/layer_approach.ipynb#W1sZmlsZQ%3D%3D?line=2&#39;&gt;3&lt;/a&gt;</span> conf = {
<span class="ansi-green-intense-fg ansi-bold">      &lt;a href=&#39;vscode-notebook-cell:/Users/nicogravel/Documents/Websites/tfrStats/tfrMVPA_local/docs/source/notebooks/layer_approach.ipynb#W1sZmlsZQ%3D%3D?line=3&#39;&gt;4&lt;/a&gt;</span>     &#39;paths&#39;    : [
<span class="ansi-green-intense-fg ansi-bold">      &lt;a href=&#39;vscode-notebook-cell:/Users/nicogravel/Documents/Websites/tfrStats/tfrMVPA_local/docs/source/notebooks/layer_approach.ipynb#W1sZmlsZQ%3D%3D?line=4&#39;&gt;5&lt;/a&gt;</span>     &#39;/Users/nicogravel/Documents/Gandalf/MWlamprop/data/results_bckp/&#39;,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">     &lt;a href=&#39;vscode-notebook-cell:/Users/nicogravel/Documents/Websites/tfrStats/tfrMVPA_local/docs/source/notebooks/layer_approach.ipynb#W1sZmlsZQ%3D%3D?line=17&#39;&gt;18&lt;/a&gt;</span>     &#39;newData&#39;: True
<span class="ansi-green-intense-fg ansi-bold">     &lt;a href=&#39;vscode-notebook-cell:/Users/nicogravel/Documents/Websites/tfrStats/tfrMVPA_local/docs/source/notebooks/layer_approach.ipynb#W1sZmlsZQ%3D%3D?line=18&#39;&gt;19&lt;/a&gt;</span>     }
<span class="ansi-green-fg">---&gt; &lt;a href=&#39;vscode-notebook-cell:/Users/nicogravel/Documents/Websites/tfrStats/tfrMVPA_local/docs/source/notebooks/layer_approach.ipynb#W1sZmlsZQ%3D%3D?line=20&#39;&gt;21&lt;/a&gt;</span> plot_tfr_rdm(conf)

File <span class="ansi-green-fg">~/Documents/Websites/tfrStats/tfrMVPA_local/tfrMVPA/plot_tfr_rdm.py:180</span>, in <span class="ansi-cyan-fg">plot_tfr_rdm</span><span class="ansi-blue-fg">(conf)</span>
<span class="ansi-green-intense-fg ansi-bold">    155</span> for fband in range(n_fband):
<span class="ansi-green-intense-fg ansi-bold">    156</span>     # Genertal configuration
<span class="ansi-green-intense-fg ansi-bold">    158</span>     conf = {
<span class="ansi-green-intense-fg ansi-bold">    159</span>         &#39;paths&#39;    : [
<span class="ansi-green-intense-fg ansi-bold">    160</span>         &#39;/Users/nicogravel/Documents/Gandalf/MWlamprop/data/results_bckp/&#39;,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    177</span>         &#39;rsa&#39;      : rsa
<span class="ansi-green-intense-fg ansi-bold">    178</span>         }
<span class="ansi-green-fg">--&gt; 180</span>     rdms  = load_tfr_rdm(conf)
<span class="ansi-green-intense-fg ansi-bold">    182</span>     rdm1 = rdms[&#39;rdm_split1&#39;]
<span class="ansi-green-intense-fg ansi-bold">    183</span>     rdm2 = rdms[&#39;rdm_split2&#39;]

File <span class="ansi-green-fg">~/Documents/Websites/tfrStats/tfrMVPA_local/tfrMVPA/load_tfr_rdm.py:104</span>, in <span class="ansi-cyan-fg">load_tfr_rdm</span><span class="ansi-blue-fg">(conf)</span>
<span class="ansi-green-intense-fg ansi-bold">    101</span>             rdm_split2[ch,fr,:,:,:] = np.squeeze(Y_t[:,:,:])
<span class="ansi-green-intense-fg ansi-bold">    103</span>         if lump == True:
<span class="ansi-green-fg">--&gt; 104</span>             Z_t = np.load(os.path.join(results_path + decvars[dvar]
<span class="ansi-green-intense-fg ansi-bold">    105</span>                                     + &#39;_Dec_ch&#39; + str(ch+1)
<span class="ansi-green-intense-fg ansi-bold">    106</span>                                     + &#39;_freq&#39; + str(fr+1)
<span class="ansi-green-intense-fg ansi-bold">    107</span>                                     + &#39;_&#39; + fbands[fband]
<span class="ansi-green-intense-fg ansi-bold">    108</span>                                     + &#39;_&#39; + methods[fband] + &#39;_norm_c.npy&#39;))
<span class="ansi-green-intense-fg ansi-bold">    110</span>             rdm_whole[ch,fr,:,:,:] = np.squeeze(Z_t[:,:,:])
<span class="ansi-green-intense-fg ansi-bold">    114</span> if rsa == True:

File <span class="ansi-green-fg">~/opt/anaconda3/envs/lamidec/lib/python3.8/site-packages/numpy/lib/npyio.py:417</span>, in <span class="ansi-cyan-fg">load</span><span class="ansi-blue-fg">(file, mmap_mode, allow_pickle, fix_imports, encoding)</span>
<span class="ansi-green-intense-fg ansi-bold">    415</span>     own_fid = False
<span class="ansi-green-intense-fg ansi-bold">    416</span> else:
<span class="ansi-green-fg">--&gt; 417</span>     fid = stack.enter_context(open(os_fspath(file), &#34;rb&#34;))
<span class="ansi-green-intense-fg ansi-bold">    418</span>     own_fid = True
<span class="ansi-green-intense-fg ansi-bold">    420</span> # Code to distinguish from NumPy binary files and pickles.

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;/Volumes/Gandalf/MWlamprop/data/grat/spw_Dec_ch1_freq1_low_hanning_norm_c.npy&#39;
</pre></div></div>
</div>
</section>
<section id="MUA">
<h1>MUA<a class="headerlink" href="#MUA" title="Permalink to this heading">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp2d</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">colors</span>

<span class="n">conf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;paths&#39;</span>    <span class="p">:</span> <span class="p">[</span>
    <span class="s1">&#39;/Users/nicogravel/Documents/Gandalf/MWlamprop/data/results_bckp/&#39;</span><span class="p">,</span>
    <span class="s1">&#39;/Volumes/Gandalf/MWlamprop/data/&#39;</span><span class="p">,</span>
    <span class="s1">&#39;/Volumes/Gandalf/MWlamprop/results/&#39;</span>
    <span class="p">],</span>
    <span class="s1">&#39;block&#39;</span>  <span class="p">:</span> <span class="s1">&#39;grat&#39;</span><span class="p">,</span> <span class="c1"># &#39;both&#39;, &#39;objects&#39;, &#39;scenes&#39;</span>
    <span class="s1">&#39;subset&#39;</span> <span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;prctl&#39;</span>  <span class="p">:</span> <span class="mi">99</span><span class="p">,</span>
    <span class="s1">&#39;lump&#39;</span>   <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;rsa&#39;</span>    <span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;newData&#39;</span><span class="p">:</span> <span class="kc">True</span>
    <span class="p">}</span>

<span class="n">paths</span> <span class="o">=</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;paths&#39;</span><span class="p">]</span>
<span class="n">rsa</span>   <span class="o">=</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;rsa&#39;</span><span class="p">]</span>
<span class="n">conds</span>   <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;grat&#39;</span><span class="p">,</span> <span class="s1">&#39;nat&#39;</span><span class="p">]</span>

<span class="n">mua_path</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">trange</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span><span class="mi">1500</span><span class="p">]</span>
<span class="n">n_tpoints_whole</span> <span class="o">=</span> <span class="mi">2800</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mi">400</span>
<span class="n">tf</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_site</span> <span class="o">=</span> <span class="mi">12</span>
<span class="k">if</span> <span class="n">rsa</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">n_tbin</span> <span class="o">=</span> <span class="mi">560</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">n_tbin</span> <span class="o">=</span> <span class="n">n_tpoints_whole</span>

<span class="n">cond</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">trialIdx_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
<span class="n">trialIdx</span> <span class="o">=</span> <span class="n">trialIdx_</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">trialIdx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">trialIdx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">800</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span> <span class="n">n_tbin</span><span class="p">)</span>
<span class="n">pt_t0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">sorter</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">pt_tf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">tf</span><span class="p">,</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">sorter</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">rho_tps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="n">n_site</span><span class="p">,</span> <span class="n">n_tbin</span><span class="p">))</span>
<span class="n">rdm_ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="n">n_site</span><span class="p">,</span><span class="n">trialIdx_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">trialIdx_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n_tbin</span><span class="p">))</span>


<span class="k">for</span> <span class="n">i_site</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_site</span><span class="p">):</span>

    <span class="c1"># MUA</span>
    <span class="k">if</span> <span class="n">rsa</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;/unsDec_ch&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i_site</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_mua_resampled_split1.npy&#39;</span>
        <span class="n">X1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mua_path</span> <span class="o">+</span> <span class="n">conds</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span> <span class="o">+</span> <span class="n">fname</span><span class="p">))</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;/unsDec_ch&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i_site</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_mua_resampled_split2.npy&#39;</span>
        <span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mua_path</span> <span class="o">+</span> <span class="n">conds</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span> <span class="o">+</span> <span class="n">fname</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i_tbin</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_tbin</span><span class="p">):</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">X1</span><span class="p">[:,:,</span><span class="n">i_tbin</span><span class="p">]</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">X2</span><span class="p">[:,:,</span><span class="n">i_tbin</span><span class="p">]</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">x1</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">trialIdx</span><span class="p">,</span><span class="n">trialIdx</span><span class="p">)]</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">x2</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">trialIdx</span><span class="p">,</span><span class="n">trialIdx</span><span class="p">)]</span>
            <span class="n">rho_tps</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="n">i_site</span><span class="p">,</span><span class="n">i_tbin</span><span class="p">]</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">spearmanr</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span><span class="n">x2</span><span class="p">[</span><span class="n">idx</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1">#rho_tps[3,i_site,i_tbin] = stats.spearmanr(x1.flatten(),x2.flatten())[0]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n_tbin</span> <span class="o">=</span> <span class="mi">2800</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;/unsDec_ch&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i_site</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_mua_resampled.npy&#39;</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mua_path</span> <span class="o">+</span> <span class="n">conds</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span> <span class="o">+</span> <span class="n">fname</span><span class="p">))</span>
        <span class="n">rdm_ts</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i_site</span><span class="p">,:,:,:]</span> <span class="o">=</span> <span class="n">X</span>
        <span class="k">for</span> <span class="n">i_tbin</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_tbin</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,:,</span><span class="n">i_tbin</span><span class="p">]</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">trialIdx</span><span class="p">,</span><span class="n">trialIdx</span><span class="p">)]</span>
            <span class="n">rho_tps</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="n">i_site</span><span class="p">,</span><span class="n">i_tbin</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
    <span class="c1"># LFP</span>
    <span class="k">if</span> <span class="n">rsa</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;/unsDec_ch&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i_site</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_lfp_bipolar_split1.npy&#39;</span>
        <span class="n">X1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mua_path</span> <span class="o">+</span> <span class="n">conds</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span> <span class="o">+</span> <span class="n">fname</span><span class="p">))</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;/unsDec_ch&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i_site</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_lfp_bipolar_split2.npy&#39;</span>
        <span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mua_path</span> <span class="o">+</span> <span class="n">conds</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span> <span class="o">+</span> <span class="n">fname</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i_tbin</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_tbin</span><span class="p">):</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">X1</span><span class="p">[:,:,</span><span class="n">i_tbin</span><span class="p">]</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">X2</span><span class="p">[:,:,</span><span class="n">i_tbin</span><span class="p">]</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">x1</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">trialIdx</span><span class="p">,</span><span class="n">trialIdx</span><span class="p">)]</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">x2</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">trialIdx</span><span class="p">,</span><span class="n">trialIdx</span><span class="p">)]</span>
            <span class="n">rho_tps</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="n">i_site</span><span class="p">,</span><span class="n">i_tbin</span><span class="p">]</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">spearmanr</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span><span class="n">x2</span><span class="p">[</span><span class="n">idx</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1">#rho_tps[3,i_site,i_tbin] = stats.spearmanr(x1.flatten(),x2.flatten())[0]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n_tbin</span> <span class="o">=</span> <span class="mi">560</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;/unsDec_layer&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i_site</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_lfp_bipolar.npy&#39;</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mua_path</span> <span class="o">+</span> <span class="n">conds</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span> <span class="o">+</span> <span class="n">fname</span><span class="p">))</span>
        <span class="c1">#rdm_ts[1,i_site,:,:,:] = X</span>
        <span class="k">for</span> <span class="n">i_tbin</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_tbin</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,:,</span><span class="n">i_tbin</span><span class="p">]</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">trialIdx</span><span class="p">,</span><span class="n">trialIdx</span><span class="p">)]</span>
            <span class="n">rho_tps</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="n">i_site</span><span class="p">,</span><span class="n">i_tbin</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>



<span class="c1">###  Plot</span>
<span class="n">twindow</span>       <span class="o">=</span> <span class="p">[</span><span class="mi">65</span><span class="p">,</span> <span class="mi">80</span><span class="p">]</span> <span class="c1"># window in the plot</span>
<span class="n">cmap</span>          <span class="o">=</span> <span class="s1">&#39;cubehelix_r&#39;</span>
<span class="n">coloff</span>        <span class="o">=</span> <span class="mf">0.5</span>        <span class="c1"># colormap center offset</span>
<span class="n">cnorm_range</span>   <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">]</span>
<span class="c1">## helper function used by plot_stats to noramlize colormap ranges</span>
<span class="k">def</span> <span class="nf">coloroffset</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>

    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Ensure k is between 0 and 1</span>
        <span class="n">point</span> <span class="o">=</span> <span class="n">min_val</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">max_val</span> <span class="o">-</span> <span class="n">min_val</span><span class="p">)</span>
        <span class="c1">#print(f&#39;For k={k}, the point in the range {min_val}-{max_val} is: {point}&#39;)</span>
    <span class="c1">#else:</span>
        <span class="c1">#print(&quot;Error: k must be between 0 and 1&quot;)</span>

    <span class="k">return</span> <span class="n">point</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ups</span>           <span class="o">=</span> <span class="mi">8</span> <span class="c1"># upsampling in figure</span>
<span class="n">x</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span> <span class="o">=</span> <span class="o">-</span><span class="mi">800</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="n">rho_tps</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=-</span><span class="mi">550</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">550</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span> <span class="o">=</span> <span class="o">-</span><span class="mi">800</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="n">rho_tps</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=-</span><span class="mi">550</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">550</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">12</span><span class="o">*</span><span class="n">ups</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">X2</span><span class="p">,</span> <span class="n">Y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
<span class="c1">#print(davg.shape)</span>
<span class="n">davg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">rho_tps</span><span class="p">[</span><span class="mi">3</span><span class="p">,:,:])</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">interp2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">davg</span><span class="p">),</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="c1"># Color map normalization</span>
<span class="n">tt0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">cnorm_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">sorter</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">ttf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">cnorm_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">sorter</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">tfrange</span> <span class="o">=</span> <span class="n">davg</span><span class="p">[:,</span><span class="n">tt0</span><span class="p">:</span><span class="n">ttf</span><span class="p">]</span>
<span class="n">_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">tfrange</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="n">_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tfrange</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<span class="c1">#print(&#39;min =&#39;,_min,&#39;max =&#39;,_max)</span>
<span class="c1">#vmin = 0 #_min</span>
<span class="c1">#vmax = _max</span>
<span class="c1">#vcenter = coloroffset(vmin, vmax, coloff)</span>
<span class="c1">#norm = colors.TwoSlopeNorm(vmin=vmin, vcenter=vcenter, vmax=vmax)</span>
<span class="n">TFR_emp</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
<span class="c1">#im_spwr = ax[0].pcolormesh(X2[:,twindow[0]:-twindow[1]], Y2[:,twindow[0]:-twindow[1]], TFR_emp[:,twindow[0]:-twindow[1]] , cmap=cmap,norm=norm)</span>
<span class="n">im_spwr</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X2</span><span class="p">[:,</span><span class="n">twindow</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="o">-</span><span class="n">twindow</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">Y2</span><span class="p">[:,</span><span class="n">twindow</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="o">-</span><span class="n">twindow</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">TFR_emp</span><span class="p">[:,</span><span class="n">twindow</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="o">-</span><span class="n">twindow</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">/Users/nicogravel/Documents/Websites/tfrStats/tfrMVPA_local/docs/source/notebooks/layer_approach.ipynb Cell 5</span> line <span class="ansi-cyan-fg">7
</span><span class="ansi-green-intense-fg ansi-bold">     &lt;a href=&#39;vscode-notebook-cell:/Users/nicogravel/Documents/Websites/tfrStats/tfrMVPA_local/docs/source/notebooks/layer_approach.ipynb#W5sZmlsZQ%3D%3D?line=67&#39;&gt;68&lt;/a&gt;</span> n_tbin = 2800
<span class="ansi-green-intense-fg ansi-bold">     &lt;a href=&#39;vscode-notebook-cell:/Users/nicogravel/Documents/Websites/tfrStats/tfrMVPA_local/docs/source/notebooks/layer_approach.ipynb#W5sZmlsZQ%3D%3D?line=68&#39;&gt;69&lt;/a&gt;</span> fname = &#39;/unsDec_ch&#39; + str(i_site+1) + &#39;_mua_resampled.npy&#39;
<span class="ansi-green-fg">---&gt; &lt;a href=&#39;vscode-notebook-cell:/Users/nicogravel/Documents/Websites/tfrStats/tfrMVPA_local/docs/source/notebooks/layer_approach.ipynb#W5sZmlsZQ%3D%3D?line=69&#39;&gt;70&lt;/a&gt;</span> X = np.load(os.path.join(mua_path + conds[cond] + fname))
<span class="ansi-green-intense-fg ansi-bold">     &lt;a href=&#39;vscode-notebook-cell:/Users/nicogravel/Documents/Websites/tfrStats/tfrMVPA_local/docs/source/notebooks/layer_approach.ipynb#W5sZmlsZQ%3D%3D?line=70&#39;&gt;71&lt;/a&gt;</span> rdm_ts[0,i_site,:,:,:] = X
<span class="ansi-green-intense-fg ansi-bold">     &lt;a href=&#39;vscode-notebook-cell:/Users/nicogravel/Documents/Websites/tfrStats/tfrMVPA_local/docs/source/notebooks/layer_approach.ipynb#W5sZmlsZQ%3D%3D?line=71&#39;&gt;72&lt;/a&gt;</span> for i_tbin in range(n_tbin):

File <span class="ansi-green-fg">~/opt/anaconda3/envs/lamidec/lib/python3.8/site-packages/numpy/lib/npyio.py:417</span>, in <span class="ansi-cyan-fg">load</span><span class="ansi-blue-fg">(file, mmap_mode, allow_pickle, fix_imports, encoding)</span>
<span class="ansi-green-intense-fg ansi-bold">    415</span>     own_fid = False
<span class="ansi-green-intense-fg ansi-bold">    416</span> else:
<span class="ansi-green-fg">--&gt; 417</span>     fid = stack.enter_context(open(os_fspath(file), &#34;rb&#34;))
<span class="ansi-green-intense-fg ansi-bold">    418</span>     own_fid = True
<span class="ansi-green-intense-fg ansi-bold">    420</span> # Code to distinguish from NumPy binary files and pickles.

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;/Users/nicogravel/Documents/Gandalf/MWlamprop/data/results_bckp/grat/unsDec_ch1_mua_resampled.npy&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;time series :&#39;</span><span class="p">,</span> <span class="n">rho_tps</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
time series : (5, 12, 560)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;in dog we trust.
      
      |
      <a href="../_sources/notebooks/layer_approach.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>