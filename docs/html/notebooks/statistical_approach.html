
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>2. A mini-tutorial… &#8212; tfrStats 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="tfrStats" href="../modules.html" />
    <link rel="prev" title="1. On TFR statistical assessments" href="../uvtfrs.html" />
    <link href="../_static/style.css" rel="stylesheet" type="text/css">

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo_2.jpg" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Content:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../uvtfrs.html">1. On TFR statistical assessments</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2. A mini-tutorial…</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Installation">2.1. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Import-libraries-and-define-functions">2.2. Import libraries and define functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Compute-p-values">2.3. Compute p-values</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#min-max">2.3.1. min-max</a></li>
<li class="toctree-l3"><a class="reference internal" href="#whole-null">2.3.2. whole-null</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Spectral-power-as-a-function-of-depth-and-space">2.4. Spectral power as a function of depth and space</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">2.4.1. min-max</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">2.4.2. whole null</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python package:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">tfrStats</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../uvtfrs.html" title="previous chapter"><span class="section-number">1. </span>On TFR statistical assessments</a></li>
      <li>Next: <a href="../modules.html" title="next chapter">tfrStats</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="../uvtfrs.html" title="Previous document"><span class="section-number">1. </span>On TFR statistical assessments</a>
        </li>
        <li>
          <a href="../modules.html" title="Next document">tfrStats</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="A-mini-tutorial...">
<h1><span class="section-number">2. </span>A mini-tutorial…<a class="headerlink" href="#A-mini-tutorial..." title="Permalink to this heading">¶</a></h1>
<p>Specifically, to assess the statistical significance of spectral estimates obtained from electrophysiological data (in this case LFP) we used non-parametric permutation tests and focused on the multiple comparison correction of time frequency representations (TFRs). We show that the success of the two approaches depends on the dimensions of the data at hand, be these spatial locations, time and frequency analysis parameters, trials of different conditions, the nature of hypothesis, etc. For
basic pedagogical purposes, here I focus on spectral power increases relative to baseline using two variants of essentially the same approach: 1) null hypothesis testing using the min-max distribution approach, which captures variations at the extremes of the null distribution, and 2) null hypothesis testing using the whole null distribution, obtained by averaging across specific dimensions.</p>
<p>Since there are several ways to achieve these goals and many realizations of these and other related methods (i.e. thresholds may be obtained from the percentiles of the null distribution directly and further corrected in equivalent ways, or the pooling of data accomplished among specific dimensions), here I focus on these two common methods using very simple examples in the hope to help those researchers (including myself) that are or may be in need of clarity on these matters, touch ground.
Depending on the approach, the computation of the p-values will change slightly. In the min-max approach the minimum and maximum values at each permutations are used. When testing using the whole null distribution, the null values obtained from the permutations are averaged the same way the empirical distribution is averaged so the dimensions of the empirical distributions are preserved in the null distribution. Once the null distributions have been obtained, p-values are obtained using the
empirical cumulative distribution. Provided the right Python environment, this Jupyter notebook should work as a simple mini-tutorial and support the discussion of these and related basic approaches for computing TFRs and assessing their statistical significance in a clear way. The methods presented here are a work in progress. I plan to make some refinements in the next few weeks. Should you be interested in employing these methods or if you have any questions, please feel free to reach out to
me. I would be more than happy to assist you further.</p>
<section id="Installation">
<h2><span class="section-number">2.1. </span>Installation<a class="headerlink" href="#Installation" title="Permalink to this heading">¶</a></h2>
<p>To run the <a class="reference external" href="https://github.com/nicogravel/tfrStats/blob/main/docs/html/notebooks/statistical_approach.ipynb">notebook</a>, clone the package (or your fork) locally and then:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/nicogravel/tfrStats.git

cd tfrStats

conda env create --name tfrStats-dev --file tfrStats.yml

conda activate tfrStats-dev

pip install -e .
</pre></div>
</div>
<p>Voilà!</p>
</section>
<section id="Import-libraries-and-define-functions">
<h2><span class="section-number">2.2. </span>Import libraries and define functions<a class="headerlink" href="#Import-libraries-and-define-functions" title="Permalink to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tfrStats.plot_tfr_stats</span> <span class="kn">import</span> <span class="n">plot_tfr_stats</span> <span class="k">as</span> <span class="n">plot_tfr_stats</span>
<span class="kn">from</span> <span class="nn">tfrStats.plot_dtfr_stats</span> <span class="kn">import</span> <span class="n">plot_dtfr_stats</span> <span class="k">as</span> <span class="n">plot_dtfr_stats</span>

<span class="c1">#in_path   = &#39;/Volumes/.../data/&#39;</span>
<span class="c1">#out_path  = &#39;/Volumes/.../results/stats/univariate/&#39;</span>
<span class="n">in_path</span>   <span class="o">=</span> <span class="s1">&#39;/Volumes/Gandalg/MWlamprop/data/&#39;</span>
<span class="n">out_path</span>  <span class="o">=</span> <span class="s1">&#39;/Volumes/Gandalf/MWlamprop/results/stats/univariate/&#39;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">/Users/nicogravel/Documents/Websites/tfrStats/tfrStats_local/docs/source/notebooks/statistical_approach.ipynb Cell 4</span> line <span class="ansi-cyan-fg">1
</span><span class="ansi-green-fg">----&gt; &lt;a href=&#39;vscode-notebook-cell:/Users/nicogravel/Documents/Websites/tfrStats/tfrStats_local/docs/source/notebooks/statistical_approach.ipynb#W3sZmlsZQ%3D%3D?line=0&#39;&gt;1&lt;/a&gt;</span> from tfrStats.plot_tfr_stats import plot_tfr_stats as plot_tfr_stats
<span class="ansi-green-intense-fg ansi-bold">      &lt;a href=&#39;vscode-notebook-cell:/Users/nicogravel/Documents/Websites/tfrStats/tfrStats_local/docs/source/notebooks/statistical_approach.ipynb#W3sZmlsZQ%3D%3D?line=1&#39;&gt;2&lt;/a&gt;</span> from tfrStats.plot_dtfr_stats import plot_dtfr_stats as plot_dtfr_stats
<span class="ansi-green-intense-fg ansi-bold">      &lt;a href=&#39;vscode-notebook-cell:/Users/nicogravel/Documents/Websites/tfrStats/tfrStats_local/docs/source/notebooks/statistical_approach.ipynb#W3sZmlsZQ%3D%3D?line=3&#39;&gt;4&lt;/a&gt;</span> #in_path   = &#39;/Volumes/.../data/&#39;
<span class="ansi-green-intense-fg ansi-bold">      &lt;a href=&#39;vscode-notebook-cell:/Users/nicogravel/Documents/Websites/tfrStats/tfrStats_local/docs/source/notebooks/statistical_approach.ipynb#W3sZmlsZQ%3D%3D?line=4&#39;&gt;5&lt;/a&gt;</span> #out_path  = &#39;/Volumes/.../results/stats/univariate/&#39;

File <span class="ansi-green-fg">~/Documents/Websites/tfrStats/tfrStats_local/tfrStats/plot_tfr_stats.py:1</span>
<span class="ansi-green-fg">----&gt; 1</span> import numpy as np
<span class="ansi-green-intense-fg ansi-bold">      2</span> import matplotlib.pyplot as plt
<span class="ansi-green-intense-fg ansi-bold">      3</span> from scipy.interpolate import interp2d

File <span class="ansi-green-fg">~/opt/anaconda3/envs/lamidec/lib/python3.8/site-packages/numpy/__init__.py:337</span>
<span class="ansi-green-intense-fg ansi-bold">    334</span> del PytestTester
<span class="ansi-green-intense-fg ansi-bold">    336</span> import mkl
<span class="ansi-green-fg">--&gt; 337</span> __mkl_version__ = &#34;{MajorVersion}.{MinorVersion}.{UpdateVersion}&#34;.format(**mkl.get_version())
<span class="ansi-green-intense-fg ansi-bold">    340</span> def _sanity_check():
<span class="ansi-green-intense-fg ansi-bold">    341</span>     &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">    342</span>     Quick sanity checks for common bugs caused by environment.
<span class="ansi-green-intense-fg ansi-bold">    343</span>     There are some cases e.g. with wrong BLAS ABI that cause wrong
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    349</span>
<span class="ansi-green-intense-fg ansi-bold">    350</span>     &#34;&#34;&#34;

<span class="ansi-red-fg">KeyboardInterrupt</span>:
</pre></div></div>
</div>
</section>
<section id="Compute-p-values">
<h2><span class="section-number">2.3. </span>Compute p-values<a class="headerlink" href="#Compute-p-values" title="Permalink to this heading">¶</a></h2>
<p>Here we plot TFRs with the significance threshold computed from p-values (i.e. p-val &lt;= 0.05) (top panel, blue trace). The alpha mask specifies the section containing the values above the null percentile cutoff (i.e. 95%). The p-values (bottom panel) with the null percentile cutoff (red trace)</p>
<section id="min-max">
<h3><span class="section-number">2.3.1. </span>min-max<a class="headerlink" href="#min-max" title="Permalink to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span>         <span class="o">=</span> <span class="s1">&#39;minmax&#39;</span>
<span class="n">null</span>         <span class="o">=</span> <span class="p">[</span><span class="mi">95</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">]</span> <span class="c1"># percentile, p-value</span>
<span class="n">fband</span>        <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">cond</span>         <span class="o">=</span> <span class="mi">0</span>

<span class="n">plot_tfr_stats</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">null</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="whole-null">
<h3><span class="section-number">2.3.2. </span>whole-null<a class="headerlink" href="#whole-null" title="Permalink to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span>         <span class="o">=</span> <span class="s1">&#39;whole&#39;</span>
<span class="n">null</span>         <span class="o">=</span> <span class="p">[</span><span class="mi">95</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">]</span> <span class="c1"># percentile, p-value</span>
<span class="n">fband</span>        <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">cond</span>         <span class="o">=</span> <span class="mi">0</span>

<span class="n">plot_tfr_stats</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">null</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Spectral-power-as-a-function-of-depth-and-space">
<h2><span class="section-number">2.4. </span>Spectral power as a function of depth and space<a class="headerlink" href="#Spectral-power-as-a-function-of-depth-and-space" title="Permalink to this heading">¶</a></h2>
<p>For this other type of TFR one must consider the pooling of data over predefined frequency bins, as well as spatial dimentions (i.e. ROIs). Therefore, the multiple correction will change slightly.</p>
<section id="id1">
<h3><span class="section-number">2.4.1. </span>min-max<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span>         <span class="o">=</span> <span class="s1">&#39;minmax&#39;</span>
<span class="n">null</span>         <span class="o">=</span> <span class="p">[</span><span class="mi">95</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">]</span> <span class="c1"># percentile, p-value</span>
<span class="n">fband</span>        <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">cond</span>         <span class="o">=</span> <span class="mi">0</span>

<span class="n">plot_dtfr_stats</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">null</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="id2">
<h3><span class="section-number">2.4.2. </span>whole null<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span>         <span class="o">=</span> <span class="s1">&#39;whole&#39;</span>
<span class="n">null</span>         <span class="o">=</span> <span class="p">[</span><span class="mi">95</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">]</span> <span class="c1"># percentile, p-value</span>
<span class="n">fband</span>        <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">cond</span>         <span class="o">=</span> <span class="mi">0</span>

<span class="n">plot_dtfr_stats</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">null</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="../uvtfrs.html" title="Previous document"><span class="section-number">1. </span>On TFR statistical assessments</a>
        </li>
        <li>
          <a href="../modules.html" title="Next document">tfrStats</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;in dog we trust.
      
      |
      <a href="../_sources/notebooks/statistical_approach.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>