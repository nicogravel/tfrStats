
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>2. A mini-tutorial &#8212; tfrStats 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="tfrStats" href="../modules.html" />
    <link rel="prev" title="1. On TFR statistical assessments" href="../uvtfrs.html" />
    <link href="../_static/style.css" rel="stylesheet" type="text/css">

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo_2.jpg" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Content:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../uvtfrs.html">1. On TFR statistical assessments</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2. A mini-tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Installl-the-package">2.1. Installl the package</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Import-libraries-and-define-functions">2.2. Import libraries and define functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Compute-p-values">2.3. Compute p-values</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#min-max">2.3.1. min-max</a></li>
<li class="toctree-l3"><a class="reference internal" href="#whole-null">2.3.2. whole-null</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Cluster-correction-of-time-frequency-bins">2.4. Cluster correction of time-frequency bins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">2.4.1. min-max</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">2.4.2. whole-null</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Spectral-power-as-a-function-of-depth-and-space">2.5. Spectral power as a function of depth and space</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">2.5.1. min-max</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">2.5.2. whole null</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Cluster-correction-of-space-frequency-bins">2.6. Cluster correction of space-frequency bins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id5">2.6.1. min-max</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">2.6.2. whole-null</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python package:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">tfrStats</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../uvtfrs.html" title="previous chapter"><span class="section-number">1. </span>On TFR statistical assessments</a></li>
      <li>Next: <a href="../modules.html" title="next chapter">tfrStats</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="../uvtfrs.html" title="Previous document"><span class="section-number">1. </span>On TFR statistical assessments</a>
        </li>
        <li>
          <a href="../modules.html" title="Next document">tfrStats</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="A-mini-tutorial">
<h1><span class="section-number">2. </span>A mini-tutorial<a class="headerlink" href="#A-mini-tutorial" title="Permalink to this heading">¶</a></h1>
<p>This codebook is a simple example meant to illustrate a two fundamental questions in time frequency analysis: 1) permutation-based null hypothesis testing and 2) correction for multiple comparisons. Typically, there is more than one approach for a given scenario. They will all depend on the dimensions of the data at hand, be these spatial locations, time and frequency analysis parameters, trials of different conditions, the nature of hypothesis, etc. For basic pedagogical purposes, here I focus
on spectral power increases relative to baseline using two variants of the same method: 1) null hypothesis testing using the traditional min-max distribution approach, which captures variations at the extremes of the null ditribution, and 2) null hypthesis testing using the whole null distribution, obtained by averaging across specific dimensions. I invite the reader to audit the code and propvide feedback and comments in the open discussion subsection within the background section. Since there
are several ways to achieve these goals and many realizations of these and other related methods (i.e. thresholds may be obtaind from the percentiles of the null distribution directly and further corrected in equivalent ways, or the pooling of data accomplished among specific dimensions), here I focus on two common methods using very simple examples in the hope to help those researchers (including myself) that are or may be in need of clarity on these matters, touch ground. Beware there may even
be error to be spot or loops to optimize.</p>
<p>Depending on the approach, the computation of the p-values will change slightly. In the min-max approach the minimum and maximum values at each permutations are used. When testing using the whole null distribution, the null values obtained from the permutations are averaged the same way the empirical distribution is averaged so the dimensions of the empirical distributions are preserved in the null distribution. Once the null distributions have been obtained, p-values are obtained using the
empirical cumulative distribution method. Additionally, an optional step is illustrated in which cluster correction of the p-values is implemented. Provided the right Python environment is installed and data, this Jupyter notebook should work as a simple mini-tutorial and support the discussion of these and related basic approaches for computing TFRs and assessing their statistical significance in a clear way. The functions within this notebook are provided in an exploratory state and are
subject to change. A background section with an open discussion subsection is included. Please feel free to use it help improve the codebook. Optionally, the package can be downloaded from here: <a class="reference external" href="https://github.com/nicogravel/tfrStats">https://github.com/nicogravel/tfrStats</a></p>
<p>The statistical map of p-values obtained using min-max seems to miss spectral and spatial detail. This leads to an overestimation of significance thresholds. While the cluster correction seems to partially remediate this, using the entire null-distribution provides more spectral and spatial detail to start to start with, making the cluster correction optional.</p>
<section id="Installl-the-package">
<h2><span class="section-number">2.1. </span>Installl the package<a class="headerlink" href="#Installl-the-package" title="Permalink to this heading">¶</a></h2>
<p>Or run the last cell in the notebook.</p>
<p>To run the <a class="reference external" href="https://github.com/nicogravel/tfrStats/blob/main/docs/html/notebooks/statistical_approach.ipynb">notebook</a>, clone the package locally (optionally forking it first) and then install it:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/nicogravel/tfrStats.git

cd tfrStats

pip install -e .
</pre></div>
</div>
<p>Voilà!</p>
</section>
<section id="Import-libraries-and-define-functions">
<h2><span class="section-number">2.2. </span>Import libraries and define functions<a class="headerlink" href="#Import-libraries-and-define-functions" title="Permalink to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tfrStats.plot_tfr_stats</span> <span class="kn">import</span> <span class="n">plot_tfr_stats</span> <span class="k">as</span> <span class="n">plot_tfr_stats</span>
<span class="kn">from</span> <span class="nn">tfrStats.plot_dtfr_stats</span> <span class="kn">import</span> <span class="n">plot_dtfr_stats</span> <span class="k">as</span> <span class="n">plot_dtfr_stats</span>


<span class="n">in_path</span>   <span class="o">=</span> <span class="s1">&#39;/Volumes/Gandalf/MWlamprop/data/&#39;</span>
<span class="n">out_path</span>  <span class="o">=</span> <span class="s1">&#39;/Volumes/Gandalf/MWlamprop/results/stats/univariate/&#39;</span>
</pre></div>
</div>
</div>
</section>
<section id="Compute-p-values">
<h2><span class="section-number">2.3. </span>Compute p-values<a class="headerlink" href="#Compute-p-values" title="Permalink to this heading">¶</a></h2>
<p>Here we plot TFRs with the significance threshold computed from p-values (i.e. p-val &lt;= 0.05) (top panel, blue trace). The alpha mask specifies the section containing the values above the null percentile cutoff (i.e. 95%). The p-values (bottom panel) with the null percentile cutoff (red trace)</p>
<section id="min-max">
<h3><span class="section-number">2.3.1. </span>min-max<a class="headerlink" href="#min-max" title="Permalink to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">null</span>         <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">95</span><span class="p">]</span>
<span class="n">alpha</span>        <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">correction</span>   <span class="o">=</span> <span class="mi">1</span>
<span class="n">cluster_size</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">fband</span>        <span class="o">=</span> <span class="mi">1</span>
<span class="n">cond</span>         <span class="o">=</span> <span class="mi">0</span>
<span class="nb">type</span>         <span class="o">=</span> <span class="s1">&#39;minmax&#39;</span>

<span class="n">plot_tfr_stats</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">null</span><span class="p">,</span> <span class="n">correction</span><span class="p">,</span> <span class="n">cluster_size</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>  <span class="c1"># pick ther min-max results and turn them into p-values</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/Volumes/Gandalf/MWlamprop/results/stats/univariate/uvtfr_stats_high_grat_spw_1000_minmax.npz
tfr emp  :  (30, 12, 16, 113)
tfr null    (1000, 30, 12, 16, 2)
(16, 113)
hola: (1000, 16, 2)
(16, 113)
min = 21.35240269384813 max = 95.0319842368204
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">UnboundLocalError</span>                         Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">/Users/nicogravel/Documents/Websites/tfrStats/tfrStats_local/docs/source/notebooks/statistical_approach.ipynb Cell 7</span> line <span class="ansi-cyan-fg">9
</span><span class="ansi-green-intense-fg ansi-bold">      &lt;a href=&#39;vscode-notebook-cell:/Users/nicogravel/Documents/Websites/tfrStats/tfrStats_local/docs/source/notebooks/statistical_approach.ipynb#W6sZmlsZQ%3D%3D?line=5&#39;&gt;6&lt;/a&gt;</span> cond         = 0
<span class="ansi-green-intense-fg ansi-bold">      &lt;a href=&#39;vscode-notebook-cell:/Users/nicogravel/Documents/Websites/tfrStats/tfrStats_local/docs/source/notebooks/statistical_approach.ipynb#W6sZmlsZQ%3D%3D?line=6&#39;&gt;7&lt;/a&gt;</span> type         = &#39;minmax&#39;
<span class="ansi-green-fg">----&gt; &lt;a href=&#39;vscode-notebook-cell:/Users/nicogravel/Documents/Websites/tfrStats/tfrStats_local/docs/source/notebooks/statistical_approach.ipynb#W6sZmlsZQ%3D%3D?line=8&#39;&gt;9&lt;/a&gt;</span> plot_tfr_stats(out_path, cond, fband, null, correction, cluster_size, type, alpha)

File <span class="ansi-green-fg">~/Documents/Websites/tfrStats/tfrStats_local/tfrStats/plot_tfr_stats.py:127</span>, in <span class="ansi-cyan-fg">plot_tfr_stats</span><span class="ansi-blue-fg">(input_path, cond, fband, null, correction, cluster_size, type, alpha)</span>
<span class="ansi-green-intense-fg ansi-bold">    125</span>     vmin = _min
<span class="ansi-green-intense-fg ansi-bold">    126</span>     vmax = _max
<span class="ansi-green-fg">--&gt; 127</span> vcenter = coloroffset(vmin, vmax, coloff)
<span class="ansi-green-intense-fg ansi-bold">    128</span> norm = colors.TwoSlopeNorm(vmin=vmin, vcenter=vcenter, vmax=vmax)
<span class="ansi-green-intense-fg ansi-bold">    129</span> TFR_emp = f(x2, y2)

<span class="ansi-red-fg">UnboundLocalError</span>: local variable &#39;coloroffset&#39; referenced before assignment
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_statistical_approach_6_2.png" src="../_images/notebooks_statistical_approach_6_2.png" />
</div>
</div>
</section>
<section id="whole-null">
<h3><span class="section-number">2.3.2. </span>whole-null<a class="headerlink" href="#whole-null" title="Permalink to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">null</span>         <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">95</span><span class="p">]</span> <span class="c1">#     results   = [&#39;_100&#39;, &#39;_100_minmax&#39;]</span>
<span class="n">alpha</span>        <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">correction</span>   <span class="o">=</span> <span class="mi">1</span>
<span class="n">cluster_size</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">fband</span>        <span class="o">=</span> <span class="mi">1</span>
<span class="n">cond</span>         <span class="o">=</span> <span class="mi">0</span>
<span class="nb">type</span>         <span class="o">=</span> <span class="s1">&#39;whole&#39;</span>

<span class="n">plot_tfr_stats</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">null</span><span class="p">,</span> <span class="n">correction</span><span class="p">,</span> <span class="n">cluster_size</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>  <span class="c1"># pick ther min-max results and turn them into p-values</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Cluster-correction-of-time-frequency-bins">
<h2><span class="section-number">2.4. </span>Cluster correction of time-frequency bins<a class="headerlink" href="#Cluster-correction-of-time-frequency-bins" title="Permalink to this heading">¶</a></h2>
<p>One can apply cluster correction either to the percetniles (using only this correction in a single step), or to the or pvalues (turning it into a second, optional step). Here we compute distances between all time-frequency bins, pool p-vals of neighbouring time-frequency bins based on a distance threshold (defined by cluster size), test if a time-frequency bin and its neighbours are below alpha, and —if true, average the p-values within the cluster and assign the resulting average as acorrected
p-value to the time-frequency bin.</p>
<section id="id1">
<h3><span class="section-number">2.4.1. </span>min-max<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">null</span>         <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">95</span><span class="p">]</span> <span class="c1">#     results   = [&#39;_100&#39;, &#39;_100_minmax&#39;]</span>
<span class="n">alpha</span>        <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">correction</span>   <span class="o">=</span> <span class="mi">2</span>
<span class="n">cluster_size</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">fband</span>        <span class="o">=</span> <span class="mi">1</span>
<span class="n">cond</span>         <span class="o">=</span> <span class="mi">0</span>
<span class="nb">type</span>         <span class="o">=</span> <span class="s1">&#39;minmax&#39;</span>

<span class="n">plot_tfr_stats</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">null</span><span class="p">,</span> <span class="n">correction</span><span class="p">,</span> <span class="n">cluster_size</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>  <span class="c1"># pick ther min-max results and turn them into p-values</span>
</pre></div>
</div>
</div>
</section>
<section id="id2">
<h3><span class="section-number">2.4.2. </span>whole-null<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">null</span>         <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">95</span><span class="p">]</span> <span class="c1">#     results   = [&#39;_100&#39;, &#39;_100_minmax&#39;]</span>
<span class="n">alpha</span>        <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">correction</span>   <span class="o">=</span> <span class="mi">2</span>
<span class="n">cluster_size</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">fband</span>        <span class="o">=</span> <span class="mi">1</span>
<span class="n">cond</span>         <span class="o">=</span> <span class="mi">0</span>
<span class="nb">type</span>         <span class="o">=</span> <span class="s1">&#39;whole&#39;</span>

<span class="n">plot_tfr_stats</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">null</span><span class="p">,</span> <span class="n">correction</span><span class="p">,</span> <span class="n">cluster_size</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>  <span class="c1"># pick ther min-max results and turn them into p-values</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Spectral-power-as-a-function-of-depth-and-space">
<h2><span class="section-number">2.5. </span>Spectral power as a function of depth and space<a class="headerlink" href="#Spectral-power-as-a-function-of-depth-and-space" title="Permalink to this heading">¶</a></h2>
<p>For this other type of TFR one must consider the pooling of data over predefined frequency bins, as well as spatial dimentions (i.e. ROIs). Therefore, the multiple correction will change slightly.</p>
<section id="id3">
<h3><span class="section-number">2.5.1. </span>min-max<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">null</span>         <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">95</span><span class="p">]</span> <span class="c1">#     results   = [&#39;_100&#39;, &#39;_100_minmax&#39;]</span>
<span class="n">alpha</span>        <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">correction</span>   <span class="o">=</span> <span class="mi">1</span>
<span class="n">cluster_size</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">fband</span>        <span class="o">=</span> <span class="mi">1</span>
<span class="n">cond</span>         <span class="o">=</span> <span class="mi">0</span>
<span class="nb">type</span>         <span class="o">=</span> <span class="s1">&#39;minmax&#39;</span>

<span class="n">plot_dtfr_stats</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">null</span><span class="p">,</span> <span class="n">correction</span><span class="p">,</span> <span class="n">cluster_size</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>  <span class="c1"># pick ther min-max results and turn them into p-values</span>
</pre></div>
</div>
</div>
</section>
<section id="id4">
<h3><span class="section-number">2.5.2. </span>whole null<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">null</span>         <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">95</span><span class="p">]</span> <span class="c1">#     results   = [&#39;_100&#39;, &#39;_100_minmax&#39;]</span>
<span class="n">alpha</span>        <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">correction</span>   <span class="o">=</span> <span class="mi">1</span>
<span class="n">cluster_size</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">fband</span>        <span class="o">=</span> <span class="mi">1</span>
<span class="n">cond</span>         <span class="o">=</span> <span class="mi">0</span>
<span class="nb">type</span>         <span class="o">=</span> <span class="s1">&#39;whole&#39;</span>

<span class="n">plot_dtfr_stats</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">null</span><span class="p">,</span> <span class="n">correction</span><span class="p">,</span> <span class="n">cluster_size</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>  <span class="c1"># pick ther min-max results and turn them into p-values</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Cluster-correction-of-space-frequency-bins">
<h2><span class="section-number">2.6. </span>Cluster correction of space-frequency bins<a class="headerlink" href="#Cluster-correction-of-space-frequency-bins" title="Permalink to this heading">¶</a></h2>
<p>One can apply cluster correction either to the percetniles (using only this correction in a single step), or to the or pvalues (turning it into a second, optional step). Here we compute distances between all space-frequency bins, pool p-vals of neighbouring space-frequency bins based on a distance threshold (defined by cluster size), test if a space-frequency bin and its neighbours are below alpha, and —if true, average the p-values within the cluster and assign the resulting average as
acorrected p-value to the space-frequency bin.</p>
<section id="id5">
<h3><span class="section-number">2.6.1. </span>min-max<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">null</span>         <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">95</span><span class="p">]</span> <span class="c1">#     results   = [&#39;_100&#39;, &#39;_100_minmax&#39;]</span>
<span class="n">alpha</span>        <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">correction</span>   <span class="o">=</span> <span class="mi">2</span>
<span class="n">cluster_size</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">fband</span>        <span class="o">=</span> <span class="mi">1</span>
<span class="n">cond</span>         <span class="o">=</span> <span class="mi">0</span>
<span class="nb">type</span>         <span class="o">=</span> <span class="s1">&#39;minmax&#39;</span>

<span class="n">plot_dtfr_stats</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">null</span><span class="p">,</span> <span class="n">correction</span><span class="p">,</span> <span class="n">cluster_size</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>  <span class="c1"># pick ther min-max results and turn them into p-values</span>
</pre></div>
</div>
</div>
</section>
<section id="id6">
<h3><span class="section-number">2.6.2. </span>whole-null<a class="headerlink" href="#id6" title="Permalink to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">null</span>         <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">95</span><span class="p">]</span> <span class="c1">#     results   = [&#39;_100&#39;, &#39;_100_minmax&#39;]</span>
<span class="n">alpha</span>        <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">correction</span>   <span class="o">=</span> <span class="mi">2</span>
<span class="n">cluster_size</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">fband</span>        <span class="o">=</span> <span class="mi">1</span>
<span class="n">cond</span>         <span class="o">=</span> <span class="mi">0</span>
<span class="nb">type</span>         <span class="o">=</span> <span class="s1">&#39;whole&#39;</span>

<span class="n">plot_dtfr_stats</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">fband</span><span class="p">,</span> <span class="n">null</span><span class="p">,</span> <span class="n">correction</span><span class="p">,</span> <span class="n">cluster_size</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>  <span class="c1"># pick ther min-max results and turn them into p-values</span>
</pre></div>
</div>
</div>
</section>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="../uvtfrs.html" title="Previous document"><span class="section-number">1. </span>On TFR statistical assessments</a>
        </li>
        <li>
          <a href="../modules.html" title="Next document">tfrStats</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;in dog we trust.
      
      |
      <a href="../_sources/notebooks/statistical_approach.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>