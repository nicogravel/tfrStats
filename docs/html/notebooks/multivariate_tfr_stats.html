<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3. Multiviariate TFR statistics, a mini-tutorial &#8212; tfrStats 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=55c3aa90" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=af2ce170"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="tfrStats" href="../modules.html" />
    <link rel="prev" title="2. Univariate TFR statistics, a mini-tutorial" href="univariate_tfr_stats.html" />
    <link href="../_static/style.css" rel="stylesheet" type="text/css">

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo_2.jpg" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Content:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../uvtfrs.html">1. On TFR statistical assessments</a></li>
<li class="toctree-l1"><a class="reference internal" href="univariate_tfr_stats.html">2. Univariate TFR statistics, a mini-tutorial</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">3. Multiviariate TFR statistics, a mini-tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Compute-RDM-reliability-using-permutations">3.1. Compute RDM reliability using permutations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Plot-RDM-reliability">3.2. Plot RDM reliability</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">tfrStats</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="univariate_tfr_stats.html" title="previous chapter"><span class="section-number">2. </span>Univariate TFR statistics, a mini-tutorial</a></li>
      <li>Next: <a href="../modules.html" title="next chapter">tfrStats</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="univariate_tfr_stats.html" title="Previous document"><span class="section-number">2. </span>Univariate TFR statistics, a mini-tutorial</a>
        </li>
        <li>
          <a href="../modules.html" title="Next document">tfrStats</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="Multiviariate-TFR-statistics,-a-mini-tutorial">
<h1><span class="section-number">3. </span>Multiviariate TFR statistics, a mini-tutorial<a class="headerlink" href="#Multiviariate-TFR-statistics,-a-mini-tutorial" title="Permalink to this heading">¶</a></h1>
<p>To run the <a class="reference external" href="https://github.com/nicogravel/tfrStats/blob/main/docs/html/notebooks/multivariate_tfr_stats.ipynb">notebook</a>, clone the package (or your fork) locally and then:</p>
<section id="Compute-RDM-reliability-using-permutations">
<h2><span class="section-number">3.1. </span>Compute RDM reliability using permutations<a class="headerlink" href="#Compute-RDM-reliability-using-permutations" title="Permalink to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import os
import numpy as np
from tfrStats.load_tfr_rdm import load_tfr_rdm as load_tfr_rdm
from tfrStats.mvtfr_reliability import mvtfr_reliability as mvtfr_reliability

fbands  = [&#39;low&#39;,&#39;high&#39;,&#39;higher&#39;,&#39;mua&#39;]
blocks   = [&#39;grat&#39;, &#39;nat&#39;,&#39;obj&#39;,&#39;bck&#39;]

#example_data = &#39;/Users/nicogravel/Documents/Websites/tfrStats/tfrStats_local/docs/source/notebooks/example_data/&#39;
example_data = &#39;/Volumes/Gandalf/MWlamprop/results/stats/multivariate/&#39;



# Loop over blocks and frequency bands
for  block in range(2,4):
    for  fband in range(1,2):

        # Configure inputs
        conf = {
            &#39;paths&#39;    : [
            &#39;/Users/nicogravel/Documents/Gandalf/MWlamprop/data/results_bckp/&#39;,
            # &#39;/mnt/hpc_slurm/projects/MWlamprop/Analysis/02_data/spectral_dec/&#39;
            #&#39;/mnt/hpc/projects/MWlamprop/Analysis/02_data/preprocessed/&#39;,
            #&#39;/mnt/pns/home/graveln/Documents/MWlamprop/results/spectral_dec/&#39;,
            #&#39;/mnt/hpc/projects/MWlamprop/Analysis/02_data/spectral_dec/&#39;,
            &#39;/Volumes/Gandalf/MWlamprop/data/&#39;,
            #&#39;/Users/nicogravel/Documents/Gandalf/MWlamprop/data/results_bckp/&#39;,
            #&#39;/Users/nicogravel/Documents/Gandalf/MWlamprop/data/processed/spectral_dec/&#39;,
            &#39;/Volumes/Gandalf/MWlamprop/results/&#39;
            ],
            &#39;methods&#39;  : [&#39;spectral&#39;,&#39;mvpa&#39;],
            &#39;decvars&#39;  : [&#39;spw&#39;,&#39;gpr&#39;,&#39;spwgpr&#39;],
            &#39;method&#39;   : 1,
            &#39;dvar&#39;     : 0,
            &#39;fband&#39;    : fband,
            &#39;cond&#39;     : block,
            &#39;sess&#39;     : 0,
            &#39;layers&#39;   : False,
            &#39;lump&#39;     : True,
            &#39;rsa&#39;      : True,
            &#39;n_perm&#39;   : 2
            }

        # Load data
        rdms  = load_tfr_rdm(conf)

        rdm1 = rdms[&#39;rdm_split1&#39;]
        rdm2 = rdms[&#39;rdm_split2&#39;]
        rdm  = rdms[&#39;rdm_whole&#39;]
        print(rdm.shape)

        # Compute reliability
        tfr, tfr_null = mvtfr_reliability(rdms,conf)

        # Prepare outputs
        tfrs = {
                &#39;tfr&#39;  : tfr,
                &#39;tfr_null&#39;  : tfr_null,
            }

        # Save outputs
        fname = os.path.join(example_data + &#39;mvtfr_&#39;
                    + blocks[block] + &#39;_&#39;
                    + fbands[fband] + &#39;_&#39; + str(conf[&#39;n_perm&#39;])
                    + &#39;.npy&#39;)
        print(fname)
        np.save(fname,tfrs)
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
session:  0
(12, 16, 36, 36, 113)
(12, 16, 36, 36, 113)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9e3514c37d61447583ebf58e04f87aef", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/Volumes/Gandalf/MWlamprop/results/stats/multivariate/mvtfr_obj_high_2.npy
session:  0
(12, 16, 36, 36, 113)
(12, 16, 36, 36, 113)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2fe525f1dbc5409da58ef3a1a4b2c092", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/Volumes/Gandalf/MWlamprop/results/stats/multivariate/mvtfr_bck_high_2.npy
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import numpy as np

# Save outputs
fname = os.path.join(example_data + &#39;mvtfr_&#39;
            + blocks[block] + &#39;_&#39;
            + fbands[fband]
            + &#39;.npy&#39;)
print(fname)
np.save(fname,tfrs)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/Users/nicogravel/Documents/Websites/tfrStats/tfrStats_local/docs/source/notebooks/example_data/mvtfr_obj_higher.npy
</pre></div></div>
</div>
</section>
<section id="Plot-RDM-reliability">
<h2><span class="section-number">3.2. </span>Plot RDM reliability<a class="headerlink" href="#Plot-RDM-reliability" title="Permalink to this heading">¶</a></h2>
<p>Similarly to the problem of taking the extreme values at each iteration of the permutaion when computing univariate TFRs. Whern computing multivariate TFRs, one is confronted with the decisio of whether to take the extreme value or the average.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import numpy as np
from tfrStats.plot_mvtfr_stats import plot_mvtfr_stats as plot_mvtfr_stats

fband         = 1
#fname = str(example_data + &#39;mvtfr_example_high.npy&#39;)
#fname = str(&#39;/Volumes/Gandalf/MWlamprop/results/stats/multivariate/&#39; +  &#39;mvtfr_bck_high_1000.npy&#39;)
#tfrs = np.load(fname,allow_pickle=True).item()
#tfr = tfrs[&#39;tfrs_emp&#39;]
#tfr_null = tfrs[&#39;tfrs_null&#39;]

fname = str(&#39;/Volumes/Gandalf/MWlamprop/results/stats/multivariate/mvtfr_nat_high_2.npy&#39;)
print(fname)
tfrs = np.load(fname,allow_pickle=True).item()
tfr_emp = tfrs[&#39;tfr&#39;]
tfr_null = tfrs[&#39;tfr_null&#39;]

plot_mvtfr_stats(tfr_emp, tfr_null, fband, alpha = 0.05, correction=&#39;space&#39;)
plot_mvtfr_stats(tfr_emp, tfr_null, fband, alpha = 0.05, correction=&#39;frequency&#39;)
plot_mvtfr_stats(tfr_emp, tfr_null, fband, alpha = 0.05, correction=&#39;space-frequency&#39;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/Volumes/Gandalf/MWlamprop/results/stats/multivariate/mvtfr_nat_high_2.npy
(16, 113)
(4, 16, 113)
dimensions : (16, 113) (4, 12, 16, 113) (4, 16, 113)
(16, 113)
(4, 12, 113)
dimensions : (16, 113) (4, 12, 16, 113) (4, 12, 113)
(16, 113)
(4, 113)
dimensions : (16, 113) (4, 12, 16, 113) (4, 113)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_multivariate_tfr_stats_5_1.png" src="../_images/notebooks_multivariate_tfr_stats_5_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_multivariate_tfr_stats_5_2.png" src="../_images/notebooks_multivariate_tfr_stats_5_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_multivariate_tfr_stats_5_3.png" src="../_images/notebooks_multivariate_tfr_stats_5_3.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import numpy as np
from tfrStats.plot_dmvtfr_stats import plot_dmvtfr_stats as plot_dmvtfr_stats

fband         = 1
fname = str(example_data + &#39;mvtfr_example_high.npy&#39;)
tfrs = np.load(fname,allow_pickle=True).item()
tfr_emp = tfrs[&#39;tfrs&#39;]
tfr_null = tfrs[&#39;tfrs_null&#39;]

plot_dmvtfr_stats(tfr_emp, tfr_null, fband, alpha = 0.05, correction=&#39;space&#39;)
#plot_dmvtfr_stats(tfr_emp, tfr_null, fband, alpha = 0.05, correction=&#39;frequency&#39;)
plot_dmvtfr_stats(tfr_emp, tfr_null, fband, alpha = 0.05, correction=&#39;space-frequency&#39;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(12, 16, 113)
(20, 12, 16, 113)
peak frequency range :  40.0 56.0
power average within peak: 0.4162180721230189
(12, 113)
null: (20, 12, 4, 113)
(20, 4, 113)
dimensions : (12, 113) (20, 12, 4, 113) (20, 4, 113)
(12, 16, 113)
(20, 12, 16, 113)
peak frequency range :  40.0 56.0
power average within peak: 0.4162180721230189
(12, 113)
null: (20, 12, 4, 113)
(20, 113)
dimensions : (12, 113) (20, 12, 4, 113) (20, 113)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_multivariate_tfr_stats_6_1.png" src="../_images/notebooks_multivariate_tfr_stats_6_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_multivariate_tfr_stats_6_2.png" src="../_images/notebooks_multivariate_tfr_stats_6_2.png" />
</div>
</div>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="univariate_tfr_stats.html" title="Previous document"><span class="section-number">2. </span>Univariate TFR statistics, a mini-tutorial</a>
        </li>
        <li>
          <a href="../modules.html" title="Next document">tfrStats</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;in dog we trust.
      
      |
      <a href="../_sources/notebooks/multivariate_tfr_stats.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>